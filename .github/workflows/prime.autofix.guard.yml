name: Reflex Guard â€“ Enforce SOD

on:
  pull_request:
    branches: [main]

jobs:
  sod-filter:
    if: contains(github.event.pull_request.labels.*.name, 'reflex-autoheal')
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - name: SOD Protected File Check (PowerShell)
        shell: pwsh
        run: |
          \ = git diff --name-only origin/main HEAD | Where-Object { \ -match '\.env|secrets\.ya?ml|prod\.ya?ml' }
          if (\) {
            Write-Host "ðŸš« SOD Violation Detected:
\"
            exit 1
          } else {
            Write-Host "âœ… SOD check passed"
          }
